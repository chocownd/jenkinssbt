pipeline {
    agent {
        docker {
            image 'mozilla/sbt'
            args '-v $HOME/.cache:/.cache'
        }
    }
    stages {
        stage('Clean') {
            steps {
                sh 'sbt "langTest/clean"'
            }
        }
        stage('Compile') {
            steps {
                sh 'sbt "langTest/compile"'
            }
        }
        stage('Run') {
            steps {
                sh 'sbt "langTest/run"'
            }
        }
        stage('Uber jar') {
            steps {
                sh 'sbt assembly'
            }
        }
        stage('Find Uber jar') {
            steps {
                sh 'ls -lah'
            }
        }
        stage('Where am I') {
            steps {
                sh 'pwd'
            }
        }
        stage('Execute Uber jar') {
            steps {
                sh 'java -jar ./lang-test/scala/target/scala-2.12/langTest-assembly-0.1.0-SNAPSHOT.jar'
            }
        }
    }
}
